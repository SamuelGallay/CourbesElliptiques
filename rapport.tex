\documentclass{article}

\usepackage[utf8]{inputenc}     % Encodage d'entrée
\usepackage[T1]{fontenc}        % Sinon Babel n'est pas content 
\usepackage{natbib}             % Pour une liste de références plus française
\usepackage{hyperref}           % Pour des liens vers les références
\usepackage{geometry}           % Pour régler les marges
\usepackage{amsfonts, amsmath}
\usepackage{amsthm, amssymb}    % Pour des symboles de maths
\usepackage{pgfplots}           % Pour les figures
\usepackage{mathtools}          % Des fractions dans des accolades  
\usepackage{setspace}           % Pour les interlignes
\usepackage[french]{babel}      % Pour le support de la langue française

\onehalfspacing

% Couleur des liens dans le document
\hypersetup{
  colorlinks = true,
  breaklinks,
  citecolor = [rgb]{.12,.54,.11},
  linkcolor = {black},
  urlcolor = {blue},
}

\pgfplotsset{compat=1.18}
\usepgfplotslibrary{external}
%\tikzexternalize % Bug avec les diagrammes commutatifs
\usetikzlibrary{cd}

% Pour les marges
\geometry{verbose,tmargin=1in,bmargin=1in,lmargin=0.7in,rmargin=1.1in}

% Math Environments
\theoremstyle{plain}% default
\newtheorem{thm}{Théorème}[section] 
\newtheorem{prop}[thm]{Proposition}
\newtheorem{deff}[thm]{Définition}
\newtheorem{lem}[thm]{Lemme}
\newtheorem{cor}[thm]{Corollaire}
\theoremstyle{definition}% default
\newtheorem{ex}[thm]{Exemple}
\newtheorem{rem}[thm]{Remarque}

\newcommand{\F}{\mathbb{F}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\U}{\mathbb{U}}
\newcommand{\h}{\widehat}
\newcommand{\ol}{\overline}

\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Aut}{Aut}


% Pour les sous-sections dans le sommaire
\setcounter{tocdepth}{2}

\title{Courbes Elliptiques}
\author{Samuel \textsc{Gallay}}
\date{\today}

\begin{document}

\maketitle





\section{Courbes elliptiques}

\subsection{Définitions}

Je donne en dessous deux définitions de ce qu'est une courbe elliptique. La première est plus générale puisqu'elle ne mentionne pas la  caractéristique du corps. La deuxième est plus pratique puisqu'elle permet de stocker une courbe dans un ordinateur, et d'effectuer des calculs dessus. Nous allons montrer que dans un corps de caractéristique différente de $2$ et de $3$, ces deux définitions sont équivalentes.

\begin{deff}[Formelle]
  Une courbe elliptique est une courbe projective lisse de genre $1$ dont a spécifié un point.
\end{deff}

\begin{deff}[Pratique]
  Soit $K$ un corps de caractéristique différente de $2$ et de $3$. Une courbe elliptique sur $K$ est un ensemble de la forme $\{(x, y)\in\ol K\ |\ y^2 = x^3 + ax +b\}\cup\{\infty\}$ ou $a$ et $b$ sont des éléments de $K$ tels que la quantité $\Delta =-16(4a^3+ 27b^2)$ soit non nulle.
\end{deff}

\begin{center}
  \color{red}
  Dans toute la suite, je suppose que les corps utilisés ne sont ni de caractéristique $2$, ni de caractéristique $3$.
\end{center}

Fixons pour cette partie un corps $K$ (de caractéristique différente de $2$ et de $3$) et notons $\overline{K}$ sa clôture algébriques. Nous allons maintenant essayer de comprendre la définition plus formelle, et d'expliquer pourquoi une courbe elliptique au sens de la définition pratique est bien une courbe elliptique au sens de la définition formelle. Le premier terme à comprendre est le mot \emph{projectif}.

\begin{deff}
  Posons $\mathcal{A} = \ol K^3\setminus(0, 0, 0)$. On définit une relation d'équivalence sur $\mathcal A$ de la sorte : étant donné $(x, y, z)$ et $(x', y', z')$ deux éléments de $A$, ces derniers sont équivalents s'il existe une constante $\lambda\in\ol K^\times$ telle que $(x, y, z) = (\lambda x', \lambda y', \lambda z')$.

  L'espace projectif $\mathbb P^2$ sur $K$ est définit comme le quotient de $\mathcal A$ par cette relation d'équivalence. 
\end{deff}

De façon moins formelle, l'espace $\mathbb P^2$ est l'ensemble des droites vectorielles de $\ol K^3$. Dans notre cadre, l'espace projectif sert uniquement à donner un cadre rigoureux à l'ajout de points à l'infini dans l'espace. Pour maintenant donner un sens à la notion de \emph{courbe}, il faut définir ce qu'est un ensemble algébrique, puis ce qu'est une variété.

\begin{deff}
  Soit $I$ un idéal de $\ol K[X, Y, Z]$ engendré par des polynômes homogènes. On définit l'ensemble $Z(I)$ par $Z(I) = \{ P\in \mathbb{P}^2 : f(P) = 0 \text{ pour tout } f \text{ homogène de } I \}$.

  Un ensemble est dit algébrique s'il est de la forme $Z(I)$ pour un certain $I$.
\end{deff}

La notation $Z(I)$ désigne ici l'ensemble des zéros communs à tous les polynômes homogènes de $I$. On ne considère que les polynômes homogènes de $I$ puisque dans l'espace projectif la propriété $f(P) = 0$ n'est pas bien définie pour des polynômes qui ne seraient pas homogènes. 
En effet, l'espace projectif est définie par un quotient et cette propriété n'est pas indépendante du choix d'un représentant. En revanche, cette propriété l'est pour des polynômes homogènes.

Donnons dès à présent un exemple d'ensemble algébrique, qui permettra d'illustrer la définition et de faire un premier lien entre les deux définitions d'une courbe elliptique.

Soient $a$ et $b$ dans $K$, et considérons le polynôme de $f(x, y) = y^2 -x^3 -ax -b$ de $K[x, y]$. 
L'intérêt de tels polynômes est que l'ensemble leurs zéros dans $\ol K$ (que nous noterons aussi $Z(f)$ ou $Z(\langle f \rangle)$) définit une courbe elliptique au sens de la définition pratique.  
Un tel polynôme n'est pas homogène, mais un procédé simple permet de l'homogénéiser. 
Posons $F(X, Y, Z) = Z^3f(\frac{X}{Z}, \frac{Y}{Z})$. 
Un tel $F$ est un polynôme homogène de $K[X, Y, Z]$, puisque $F(X, Y, Z) = Z^3\big((\frac{Y}{Z})^2 - (\frac{X}{Z})^3 -a\frac{X}{Z}-b\big) = Y^2Z - X^3 -aXZ^2 -bZ^3$. 
En considérant $\langle F \rangle$ l'idéal de $\ol K[X, Y, Z]$ engendré par $F$, $Z(\langle F \rangle)$ définit bien un ensemble algébrique. Pour alléger les notations, on notera $Z(F)$ à la place de $Z(\langle F\rangle)$. 

\vspace{0.5em}

Continuons de faire le lien entre $\ol K^2$ et $\mathbb P^2$. Pour $x, y$ et $z$ des éléments de $\ol K$, la notation $[x, y, z]$ désigne la classe d'équivalence de $(x, y, z)$ dans $\mathbb P^2$.

\begin{prop}
 Notons $U = \{[x, y, z]\in \mathbb P^2\ |\ z\neq 0\}$. L'application $\phi : \ol K^2 \to U$, définie par $\phi(x, y) = [x, y, 1]$ est bijective. 
\end{prop}

\begin{proof}
  Soit $[x, y, z]\in U$. On vérifie facilement que le couple $(\frac{x}{z}, \frac{y}{z})$ est l'unique antécédent de $[x, y, z]$ par $\phi$.
\end{proof}

La proposition précédente montre que $\mathbb P^2$ contient une copie de $\ol K^2$. Montrons que $Z(F )$ contient une copie de $Z(f)$ par le même isomorphisme. 

\begin{prop}
  Avec les mêmes notations que la question précédente, $\phi$ induit une bijection entre $Z(f)$ et $Z(F) \cap U$.
\end{prop}

\begin{proof}
  Soit $(x, y)\in\ol K^2$ tel que $f(x, y) = 0$, alors $F([x, y, 1]) = 1^3f(\frac{x}{1}, \frac{y}{1}) = f(x, y) = 0$.
  Réciproquement, soit $[x, y, z]\in U$. Si $F([x, y, z]) = 0$, alors $z^3f(\frac{x}{z}, \frac{y}{z}) = 0$, donc $f(\frac{x}{z}, \frac{y}{z}) = 0$.
\end{proof}

On peut maintenant s'intéresser aux points de $Z(F)\setminus U$. Soit $[x, y, z]\in Z(F)\setminus U$. Alors $z=0$ et $0 = F(x,y, z) = F(x, y, 0) = -x^3$, donc $x=0$. Ainsi $[x, y, z] = [0, y, 0] = [0, 1, 0]$, car $y$ ne peut pas être nul puisque $[0, 0, 0]$ n'appartient pas à $\mathbb P^2$. On vient de montrer que le seul point de $Z(F)$ qui n'appartient pas à $U$ est $[0, 1, 0]$, et c'est ce point que l'on considérera comme "point à l'infini" dans $\ol K^2$. Ainsi on a une correspondance simple entre $Z(f) \cup \{\infty\}$ et $Z(F)$.
L'espace projectif a un intérêt théorique puisque beaucoup de résultats s'y expriment de façon bien plus élégantes, mais en pratique, dans un ordinateur on effectuera les calculs dans $\ol K^2$ qui est plus facile à manipuler.

\begin{deff}
  À un ensemble algébrique $V$, on associe un idéal :
  $$I(V) = \{ f\in \overline{K}[X, Y, Z] : f \text{ est homogène et } f(P) = 0 \text{ pour tout } P\in V \}$$
  Si $I(V)$ est premier dans $ \overline{K}[X, Y, Z] $, on dit que $V$ est une variété (projective). Si $I(V)$ est engendré par des polynômes homogènes de $k[X, Y, Z]$, on dit que $V$ est définie sur $K$.  
\end{deff}


Continuons l'exemple précédent en montrant que $Z(f)$ est une variété.
  Le polynôme $f$ défini précédemment est un polynôme de homogène irréductible de $K[X, Y, Z]$.   
  Quel que soit l'idéal $I$ de $K[X, Y, Z]$, il est toujours vrai que $I \subseteq I(Z(I))$, donc $\langle F \rangle \subseteq I(Z( F ))$. 
  Dans ce cas particulier, il se trouve que la réciproque est vraie. Soit $g\in I(Z(F))$ : par la version forte du théorème des zéros de Hilbert (que nous ne démontrons pas ici), il existe $n\in\N^*$ tel que $g^n\in \langle F \rangle$.
  Puisque $\ol K[X, Y, Z]$ est factoriel et puisque $F$ est irréductible,  $\langle F \rangle$ est premier. Ainsi $g\in \langle F \rangle$ et donc $I(Z(F)) = \langle F \rangle$.
  On en déduit que $V$ est une variété (projective) définie sur $K$.

  Nous pouvons enfin donner la définition d'une courbe projective :

\begin{deff}
  Une courbe (projective) est une variété de dimension $1$ de l'espace (projectif).
\end{deff}


Je n'ai pas envie de définir formellement (de manière purement algébrique) la dimension d'une variété, mais on peut se convaincre que $Z(f) = \{(x, y)\in \ol K^2\ |\ y^2 = x^3 + ax + b\}$ est de dimension $1$ par analogie avec le cas réel puisque étant donné une valeur de $x\in\ol K$, il existe au plus deux valeurs de $y\in\ol K$ telles que $(x, y)\in Z(f)$. 


La condition sur $\Delta$ implique que cette variété est lisse. Ce qui est plus difficile est de montrer  qu'une telle courbe est de genre $1$. 

Le point spécifié de la courbe projective est le point $[0, 1, 0]$, qui correspond au point à l'infini. Ceci "justifie" qu'une courbe elliptique au sens de la définition pratique est bien une courbe elliptique au sens de la définition formelle. 

Ce qui est plus difficile, c'est de montrer que toute courbe elliptique au sens de la première définition est bien une courbe elliptique au sens de la seconde... L'outil clef est le théorème de Riemann-Roch.

\vspace{0.5em}
À partir de maintenant, lorsque l'on considérera une courbe elliptique $E$ définie sur $K$, ce que l'on notera $E/K$, cela signifiera que l'on s'est donné une équation $y^2 = x^3 + ax + b$, $a$ et $b$ étant des éléments de $K$ tels que $\Delta =-16(4a^3+ 27b^2)$ soit non nulle, et que l'on étudiera l'ensemble des solutions de cette équation dans $\ol K^2\cup \{\infty\}$ avec la convention que $\infty$ est solution de l'équation.


\subsection{La loi de groupe d'une courbe elliptique}

Ce qui rend les courbes elliptiques intéressantes, notamment en cryptographie, c'est que l'on peut les munir d'une loi de groupe. Soit $E/K$ une courbe elliptique. Nous allons construire une loi sur $E$ notée $+$ telle que $(E, +, \infty)$ formera un groupe abélien.

Il y a différents cas à traiter pour définir l'addition de deux points E.
Tout d'abord, si l'un des points est égal à $\infty$ : $\infty+P = P+\infty = P$.
Maintenant traitons le cas où les deux points sont différents de $\infty$. Notons ces deux points $P_1$ et $P_2$, et leurs coordonnées $(x_1, y_1)$ et $(x_2, y_2)$.

Si $x_1\neq x_2$, on considère la droite $\mathcal D$ passant par $P_1$ et $P_2$. La pente de cette droite est $m = \frac{y_2-y_1}{x_2-x_1}$ et son équation est $y = m(x-x_1) + y_1$. Les points d'intersection entre la droite $\mathcal D$ et $E$ sont les points $(x, y)$ vérifiant $y^2 = x^3 + ax + b$ et $y = m(x-x_1) + y_1$. En combinant les deux équations, on obtient $(m(x-x_1) + y_1)^2 =  x^3 + ax + b$. 
En ne cherchant à expliciter que les termes de degré $2$ et $3$ en $x$, on obtient: $ x^3 -m^2x^2 + \alpha x + \beta = 0$. 
Cette équation est de degré $3$ en $x$, mais on en connait déjà  deux solutions $x_1$ et $x_2$, donc en utilisant les relations racines coefficients, on obtient $x_1+x_2+x_3 = m^2$ soit $x_3 = m^2 - x_1 - x_2$ où $x_3$ est la troisième solution. La valeur de $y_3$ est $m(x_3-x_1)+y_1$ en réutilisant l'équation de la droite. On définit le point $P_1 + P_2$ comme le point de coordonnées $(x_3, -y_3)$.

Si $x_1=x_2$ et $y_1\neq y_2$, on définit $P_1+P_2$ comme valant $\infty$.

Enfin si $P_1 = P_2$, on considère la tangente à $E$ passant par $P_1$. Pour trouver la pente de la tangente, on dérive l'équation de la courbe par rapport à $x$ : $2y\frac{dy}{dx} = 3x^2 + a$, donc $m = \frac{3x_1^2 + a}{2y_1}$. On peut montrer que si $y_1 = 0$, alors $3x_1^2 + a \neq 0$. 
(On montre que $\Delta \neq 0$ si et seulement si $(x^3 + ax + b)\wedge(3x^2 + a) = 1$). 
Dans ce cas particulier, on définit $P_1+P_1$ comme valant $\infty$.
Si  $y_1 \neq  0$, $m$ est bien défini et on construit $P_1+P_1$ comme précédemment.

Il est remarquable que la loi définie ci-dessus soit une loi de groupe. Le point $\infty$ est l'élément neutre par définition. Il est facile de voir que la loi est commutative. En effet, la droite passant par $P_1$ et $P_2$ est la même que la droite passant par $P_2$ et $P_1$. L'opposé de l'élément $(x_1, y_1)$ est l'élément $(x_1, -y_1)$. Le plus dur est de montrer l'associativité de cette loi. Il est possible de tout écrire à la main, mais il est aussi possible de procéder de façon plus élégante.


\subsection{Un premier protocole d'échange de clefs}


Nous décrivons dans cette section le protocole d'échange de clefs de Diffie et Hellman. 
Soit $G = \langle g \rangle$ un groupe monogène supposé connu de tous. On suppose que le générateur $g$ ainsi que l'ordre $n$ du groupe sont publics.

Deux individus Alice et Bob cherchent à partager un élément du groupe $G$ sans qu'un espion Eve capable d'écouter toutes leurs communications ne puisse l'identifier. Voici les étapes suivies par Alice et Bob :
\begin{enumerate}
  \item Alice et Bob choisissent chacun un entier compris entre $1$ et $n-1$ qu'ils gardent secret. Notons $a$ l'entier d'Alice et $b$ celui de Bob.
  \item Alice calcule $g^a$ et l'envoie à Bob. Bob calcule $g^b$ et l'envoie à Alice.
  \item Alice calcule $(g^b)^a$ connaissant $a$ et $g^b$. Bob calcule $(g^a)^b$ connaissant $b$ et $g^a$.
\end{enumerate}
Puisque $(g^b)^a = g^{ab} = (g^a)^b$, Alice et Bob partagent un secret commun. Ève ayant écouté toutes les communications connait $g$, $n$, $g^a$ et $g^b$. Évidemment, si Ève parvient à retrouver $a$ ou $b$, elle peut retrouver $g^{ab}$. 

L'opération consistant à calculer $g^a$ en connaissant $a$ peut se faire en $O(\log a) = O(\log n)$ opérations dans le groupe par l'algorithme d'exponentiation rapide. Le problème inverse consistant à chercher $a$ en connaissant $g^a$ s'appelle le problème du logarithme discret. Sur un groupe générique, c'est à dire sans information particulière sur le groupe, les meilleurs algorithmes sont de complexité $O(\sqrt{n})$ : voir l'algorithme $\rho$ de Pollard par exemple.



\subsection{Morphismes et isogénies}

\begin{deff}
  Soient $E_1$ et $E_2$ deux courbes elliptiques définies sur $K$. Un morphisme $\phi : E_1\to  E_2$ est une application de la forme $\phi(x, y) = (R_1(x, y), R_2(x, y))$ avec $R_1$ et $R_2$ des fractions rationnelles en $x$ et $y$ qui envoie $\infty_{E_1}$ sur $\infty_{E_2}$.
\end{deff}

\begin{rem}
  A priori les fractions rationnelles peuvent être définies sur n'importe extension de $L$ de $K$. On dit alors que le morphisme est défini sur $L$.
\end{rem}

\begin{thm}
  Soit $E_1/K$ et $E_2/K$ deux courbes elliptiques. Un morphisme $\phi : E_1\to  E_2$ défini sur $L$ une extension de $K$ (possiblement égale à $K$) induit un morphisme de groupe entre $E_1(L)$ et $E_2(L)$. 
\end{thm}

Le théorème précédent permet de donner les définitions usuelles associées aux ensembles d'endomorphismes. Soit $E/K$, $E_1/K$ et $E_2/K$ trois courbes elliptiques définies sur $K$ et soit $L$ une extension de $K$.

\begin{deff}
  On note $\Hom_L(E_1, E_2)$ l'ensemble des morphismes de $E_1$ dans $E_2$ définis sur $L$. En définissant l'addition de morphismes comme l'addition point par point, $\Hom_L(E_1, E_2)$ devient un groupe abélien.
\end{deff}

\begin{deff}
  On note $\End_L(E)$ le groupe $\Hom_L(E, E)$. Muni de la loi de composition des morphismes, $\End_L(E)$ est un anneau intègre. Les éléments de $\End_L(E)$ sont appelés endomorphismes de $E$.
\end{deff}


 Nous donnons maintenant une forme plus simple aux isogénies :


\begin{prop}
  Un morphisme $\phi$ peut toujours se mettre sous la forme $\phi(x, y) = (r_1(x), r_2(x)y)$ avec $r_1$ et $r_2$ des fonctions rationnelles (i.e. des quotients de polynômes en $x$).
\end{prop}

\begin{proof}
  Soit $R(x, y)$ une fraction rationnelle. Puisque les points de $E$ vérifient $y^2 = x^3 + ax + b$, on peut éliminer les puissances de $y$ plus grande que $2$ au numérateur et au dénominateur de $R$. On peut donc supposer $R$ de la forme : $$R(x, y) = \frac{p_1(x) + p_2(x)y}{p_3(x)+p_4(x)y} = \frac{(p_1(x) + p_2(x)y)(p_3(x)-p_4(x)y)}{p_3(x)^2 - p_4(x)^2y^2} = \frac{q_1(x) +q_2(x)y}{q_3(x)} $$
 On a multiplié le dénominateur et le numérateur par la quantité conjuguée $(p_3-p_4y)$ et réutilisé l'équation de la courbe pour éliminer $y$ au dénominateur.

 Le morphisme $\phi$ peut se mettre sous la forme $\phi(x, y) = (R_1(x, y), R_2(x, y))$ avec $R_1$ et $R_2$ de la forme donnée ci-dessus. Puisque $\phi$ est un morphisme de groupes, 
 $(R_1(x, -y), R_2(x, -y)) = \phi(x, -y) = \phi(-(x, y)) = -\phi(x, y) = (R_1(x, y), -R_2(x, y))$, donc on peut réécrire $R_1(x, y) = p_1(x) / q_1(x)$ et $R_2(x, y) = p_2(x)y/q_2(x)$. On obtient bien la forme désirée. {\color{red}Il faut que je donne la formule de l'opposé d'un point sur une courbe.}
\end{proof}

\begin{rem}
  Si deux fractions rationnelles en $x$ prennent les mêmes valeurs sur une infinité de points alors elles sont égales. Les isogénies sont définies sur $E(\overline{K})$ (les points de la courbe elliptique sur la clôture algébrique de $K$) qui est infini, donc l'écriture précédente est unique.
\end{rem}


\begin{deff}
  Une isogénie est un morphisme non constant.
\end{deff}

Notons dès à présent qu'étant donné deux courbes elliptiques définies sur un corps $K$, il est a priori difficile de trouver une isogénie entre elles.

\begin{thm}
  Une isogénie est surjective.  
\end{thm}

\begin{proof}
  C'est magique !
\end{proof}

\begin{prop}
  Soit $E/K$ et soit $m\in\Z$. L'application $[m] : E \to E, P \mapsto mP$ est un endomorphisme de $E$ défini sur $K$. 
\end{prop}

\begin{deff}
  Soit $E/K$ une courbe elliptique. Pour $m\in\Z$, on définit la $m$-torsion de $E$ par $ E[m] = \Ker([m])= \left\{ P\in E(\overline{K}) \ \vert\  mP = O \right\}$.
\end{deff}


\begin{prop}
  Le morphisme $[m]$ commute avec tous les morphismes. 
\end{prop}

\begin{proof}
  Soit $\phi : E_1\to E_2$ un morphisme et $m\in\Z$. Soit $P\in E_1$. $(\phi \circ [m]_{E_1})(P) = \phi(P + \ldots + P) = \phi(P) + \ldots + \phi(P) = ([m]_{E_2} \circ \phi)(P)$.
\end{proof}

\begin{deff}[Degré d'un morphisme]. 
  Soit $\phi : E_1 \to E_2$ une isogénie. La fonction $\phi^* : K(E_2) \to K(E_1)$ définie par $\phi^*(f) = f \circ \phi$ est une injection entre deux corps. On peut montrer que l'extension $K(E_1)/\phi^*(K(E_2))$ est finie (voir R. Hartstone, Algebraic Geometry). On définit le degré de $\phi$ comme le degré de cette extension.
  
  Par convention, on décrète que le degré du morphisme $[0]$ vaut $0$.
\end{deff}

Le degré d'une extension finie $L/K$ est la dimension de $L$ en temps que $K$-espace vectoriel et est noté $[L : K$].

\begin{rem}
  
\end{rem}

\begin{prop}
  Le degré est multiplicatif. Soient $\phi : E_1\to E_2$ et $\psi : E_2\to E_3$ deux morphisme. Alors $\deg(\psi \circ \phi) = \deg(\psi)\deg(\phi)$ 
\end{prop}

\begin{proof}
  Le cas où $\phi$ ou $\psi$ est nul est trivial. Dans le cas ou $\phi$ et $\psi$ sont des isogénies, cela vient directement de la multiplicativité du degré d'une extension de corps : $\deg(\psi \circ \phi) = [K(E_3) :K(E_1)] = [K(E_3):K(E_2)][K(E_2):K(E_1)] = \deg(\psi)\deg(\phi)$. La preuve de la multiplicativité du degré d'extensions finies peut se faire de façon élémentaire en considérant des bases $(e_i)_i$ du $K(E_1)$-espace vectoriel $K(E_2)$ et $(f_j)_j$ du $K(E_2)$-espace vectoriel $K(E_3)$ et en montrant que la famille $(e_if_j)_{ij}$ forme une base du $K(E_1)$-espace vectoriel $K(E_3)$.
\end{proof}

On cherche maintenant à avoir une forme canonique pour effectuer des calculs sur les isogénies, et pour pouvoir calculer plus facilement leur degré.
La proposition suivante va nous permettre de lire le degré d'une isogénie sur son expression canonique définie précédemment.

\begin{prop}
  \label{caracdeg}
  Soit $\phi = (r_1(x), r_2(x)y)$ une isogénie. La fonction rationnelle $r_1$ peut se mettre sous la forme $r_1(x) = p(x) / q(x)$ avec $p$ et $q$ des polynômes premiers entre eux. Le degré de $\phi$ est alors égal au maximum des degrés de $p$ et de $q$. 
\end{prop}

\begin{proof}
  Admise. 
\end{proof}

Avec le degré, une autre propriété importante des isogénies est leur caractère séparable ou non.

\begin{deff}
  Une isogénie $\phi$ est dite séparable, inséparable, ou purement inséparable si c'est le cas de l'extension $K(E_1) / \phi^*(K(E_2))$.
\end{deff}

On rappelle brièvement la notion de séparabilité pour une extension de corps. Une extension algébrique $L/K$ est dite séparable si pour tout $a\in L$, le polynôme minimal de $a$ à coefficients dans $K$ ne contient que des racines simples (dans $\overline{K}$). On dit qu'une extension est inséparable quand elle n'est pas séparable, c'est à dire quand il existe un élément dont le polynôme minimal sur $K$ n'est pas à racines simples dans $\overline{K}$. Les extensions purement inséparables sont un cas particulier d'extensions séparables où tous les éléments $a\in L \setminus K$ ont un polynôme qui n'est pas à racines simples.

Un outil pour étudier la séparabilité d’une extension de corps est la notion de degré de séparabilité (ou
degré séparable). Soit $L/K$ une extension algébrique. Le degré de séparabilité de $L/K$ noté  $[L : K]_s$ est défini
formellement comme le nombre de prolongements à $L$ du morphisme d’inclusion de $K$ dans $K$. Les seules
propriétés que nous allons utiliser sont les trois suivantes :

\begin{prop}
 Le degré de séparabilité, comme le degré d’une extension, est multiplicatif : [M : K]s =
[M : L]s [L : K]s.
\end{prop}

\begin{prop}
  Pour une extension algébrique L/K, [L : K]s divise [L : K]. De plus [L : K]s = [L : K] si
et seulement si l’extension L/K est séparable.
\end{prop}

\begin{prop}
  Une extension de corps algébrique  L/K non triviale (i.e. L= K) est purement inséparable si et seulement si son degré de séparabilité est égal à 1. Est-ce que c’est vrai ça ?
\end{prop}


On définit alors le degré de séparabilité $\deg_s(\phi)$ d’une isogénie $\phi : E_1 \to E_2$ comme le degré de séparabilité de l’extension $K(E_1)/\phi^*(K(E_2 ))$.
Ici encore, la forme canonique donnée aux isogénies précédemment permet de donner caractérisation plus
simple de la séparabilité.

\begin{prop}
  \label{caracsep}
  Une isogénie $\phi(x, y) = (r_1(x), r_2(x)y)$ est séparable si et seulement si $r_1'(x) \neq 0$.
\end{prop}

Nous introduisons maintenant le morphisme de Frobenius, qui est l'exemple le plus important d'isogénie inséparable.

\begin{deff}
  Soit $E/\F_q : y^2 = x^3 + ax + b$ une courbe elliptique avec $q = p^n$. Pour tout $r$ puissance de $p$ on définit la courbe $E^{(r)}$ par l'équation $y^2 = x^3 + a^r x + b^r$. On appelle morphisme de Frobenius l'application $\pi_r : E \to E^{(r)}$ qui à $(x, y)$ associe $(x^r, y^r)$. On remarque que si $r$ est une puissance de $q$, $\pi_r$ est un endomorphisme.
\end{deff}


\begin{rem}
  \label{degpi}
  Par les propositions \ref{caracdeg} et \ref{caracsep}, on déduit immédiatement que $\pi_r$ est une isogénie inséparable de degré $r$. Les propositions et corollaire suivants vont montrer que toute isogénie de $E/\F_q$ peut s'écrire comme la composition d'une isogénie séparable 
\end{rem}



\begin{prop}
  Soit $k$ un corps de caractéristique $p$. Soit $\phi(x, y) = (r_1(x), r_2(x)y)$ une isogénie avec $r_1(x) = u(x)/v(x)$, $u$ et $v$ étant des polynômes de $\overline{K}[x]$ premiers entre eux. Alors $\phi$ est inséparable si et seulement si il existe deux polynômes $f$ et $g$ tels que $u(x) = f(x^p)$ et $v(x) = g(x^p)$.
\end{prop}


\begin{proof}
  Supposons $\phi$ inséparable, soit $r_1' = 0$ par \ref{caracsep}. Puisque $0 = r_1' = \frac{u'v -uv'}{v^2}$ on obtient que $u'v = uv'$, et puisque $u$ et $v$ sont premiers entre eux, $u$ divise $u'$, ce qui implique que $u' = 0$ pour des raisons de degré.  En notant $u(x) = \sum_{k=0}^{+\infty} a_kx^k$, on obtient $0 = u'(x) = \sum_{k=0}^{+\infty} ka_kx^{k-1}$ et donc $\forall k\in \N, ka_k = 0$. Puisque $\overline{K}$ est de caractéristique $p$, cela implique que $a_k = 0$ si $p\not\equiv 0\ [p]$. Ainsi il existe bien $f$ tel que $u(x) = f(x^p)$. De même, $v(x) = g(x^p)$. 

  Réciproquement, si $u(x) = f(x^p)$ et $v(x) = f(x^p)$, $u'(x) = f'(x^p)\cdot px^{p-1} = 0$ et de même pour $v$, donc $u' = v' = 0$. Alors $r_1' = (\frac{u}{v})' =  \frac{u'v -uv'}{v^2} = 0$, et donc $\phi$ est inséparable par \ref{caracsep}.
\end{proof}



\begin{cor}
  Soit $E_1/\F_q$ une courbe elliptique. Toute isogénie $\phi : E_1 \to E_2 $ peut s'écrire $\phi = \psi \circ \pi_p^n$ avec $n\in \N$ et $\psi$ une isogénie séparable.
\end{cor}

\begin{proof}
  Si $\phi$ est séparable, il n'y a rien à démontrer. Supposons $\phi$ inséparable : par la proposition précédente il existe $\psi_1$ tel que $\phi = \psi_1 \circ \pi_p$. Tant que $\psi_k$ est inséparable, on réapplique la proposition $\psi_k$ et on a donc $\phi = \psi_k \circ \pi_p^k$. 
  Par multiplicativité du degré $\deg(\phi) = \deg(\psi_k)\deg(\pi_p^k) = \deg(\psi_k)\cdot p^k$.
  Ainsi le processus termine, et donc il existe $\psi$ séparable et $n\in \N$ tels que $\phi = \psi \circ \pi_p^n$.
\end{proof}

\begin{rem}
  Cette expression est unique. Supposons que $\phi = \psi_a \circ \pi_p^{n_a} = \psi_b \circ \pi_p^{n_b}$ comme dans le corollaire précédent. Sans perte de généralité on peut supposer que $n_a \le n_b$. Alors $(\psi_a - \psi_b \circ \pi_p^{n_b - n_a}) \circ \pi_p^{n_a} = 0$, donc en utilisant la multiplicativité du degré et la convention $\deg(0) = 0$, on obtient $\psi_a = \psi_b \circ \pi_p^{n_b - n_a}$. Puisque $\psi_a$ est séparable, en utilisant la proposition $\ref{caracsep}$ on en déduit que $n_a = n_b$, et donc $\psi_a = \psi_b$.
\end{rem}

\begin{thm}
  \label{existence_duale}
  Soit $\phi : E_1\to E_2$ une isogénie (non constante). Il existe une unique isogénie $\h\phi : E_2\to E_1$ telle que $\h\phi \circ \phi = [\deg\phi]$. Elle est appelée l'isogénie duale de $\phi$.
\end{thm}

\begin{proof}
  Admise. 
\end{proof}

\begin{rem}
  Dans le cas où $\phi = [0]$, on définit $\h\phi = [0]$. {\color{red} Il faut que je décide si j'autorise les isogénies à être constantes dans ma définition}.
\end{rem}

\begin{prop}
  \label{propriétés_duale}
  Soit $\phi : E_1 \to E_2$ une isogénie et $\h\phi$ sa duale.  
  \begin{enumerate}
    \item $\h\phi\circ\phi = [\deg{\phi}]$ sur $E_1$ et $\phi\circ\h\phi = [\deg{\phi}]$ sur $E_2$.
    \item Soit $\lambda :E_2\to E_3$ une autre isogénie. Alors $\h{\lambda\circ\phi} = \h\phi\circ\h\lambda$.
    \item Soit $\psi :E_1\to E_2$ une autre isogénie. Alors $\h{\phi+\psi} = \h\phi + \h\psi$.
    \item Pour tout $m\in\Z$, $\h{[m]} = [m]$ et $\deg([m]) = m^2$.
    \item $\deg\h\phi = \deg\phi$ et $\h{\h\phi} = \phi$.
  \end{enumerate}
\end{prop}

\begin{proof}
  On va admettre beaucoup de choses pour le moment.
  \begin{enumerate}
    \item Par le théorème \ref{existence_duale} la propriété $\h\phi\circ\phi = [\deg{\phi}]_{E_1}$ est la définition de l'isogénie duale. Pour la deuxième partie, on observe que $(\phi\circ\h\phi)\circ\phi = \phi\circ(\h\phi\circ\phi) = \phi\circ[\deg{\phi}]_{E_1} = [\deg{\phi}]_{E_2}\circ\phi$ et donc $\phi$ étant surjective, on obtient bien $\phi\circ\h\phi = [\deg{\phi}]_{E_2}$.
    \item En remarquant que $(\h\phi\circ\h\lambda)\circ(\lambda\circ\phi) = \h\phi\circ [\deg\lambda]_{E_2} \circ\phi = [\deg\lambda]_{E_1}\circ\h\phi\circ\phi = [\deg\lambda]_{E_1}\circ [\deg\phi]_{E_1} = [\deg(\lambda)\deg(\phi)] = [\deg(\lambda\circ\phi)]$ et en utilisant le théorème \ref{existence_duale}, on montre que $\h{\lambda\circ\phi} = \h\phi\circ\h\lambda$.
    \item Je ne le démontre pas car la démonstration est un peu technique.
    \item Montrons d'abord par récurrence que pour $m\in\N$, $\h{[m]} = [m]$. Le cas $m=0$ est vrai par définition (voir la remarque précédente). Les cas $m = \pm 1$ se montrent par le théorème \ref{existence_duale} en sachant que puisque $[1](x, y) = (x, y)$ et $[-1](x, y) = (x, -y)$, on montre par la proposition \ref{caracdeg} que $\deg[-1] = \deg[1] = 1$. La propriété étant vraie à un certain rang $m$, le point $2$ montre l'hérédité : $\h{[m+1]} = \h{[m] + [1]} = \h{[m]} + \h{[1]} = [m] + [1] = [m+1]$ et $\h{[m-1]} = \h{[m] + [-1]} = \h{[m]} + \h{[-1]} = [m] + [-1] = [m-1]$.
      Enfin $[\deg [m]] = \h{[m]} \circ [m] = [m] \circ [m] = [m^2]$ montre la deuxième partie de l'assertion, le morphisme $[]:\Z\to \End_{E_1}$ étant injectif.
    \item Par le point précédent, $ (\deg\phi)^2=\deg([\deg\phi])=\deg(\h\phi\circ\phi) = (\deg\h\phi)(\deg\phi)$, donc $\deg\h\phi = \deg\phi$. Avec le point $1$, $\phi\circ\h\phi = [\deg\phi] = [\deg \h\phi]$, donc en réutilisant le théorème \ref{existence_duale} on obtient bien $\h{\h\phi} = \phi$.
  \end{enumerate}
\end{proof}

\section{Étude du graphe des isogénies}
Le but de cette partie est de montrer que le graphes des isogénies entre $\overline{\F_p}$-isomorphismes de courbes elliptiques supersingulières définies sur $\F_{p^2}$ est connexe. Il me manque encore un bon nombre de définitions et de propriétés : introduire ce qu'est une isogénie, son degré, la notion d'isogénie duale, le pairing de Weil\ldots

\begin{deff}
  Soit $\phi\in \End(E)$, et soit $l$ un nombre premier. $\phi$ induit un endomorphisme $\phi_l : E[l] \to E[l]$. Si $l\neq p$, $\phi_l$ est un endomorphisme du $\Z/l\Z$-espace vectoriel de dimension $2$ $E[l]$. 
\end{deff}

\begin{prop}
  \label{pairing}
  Il existe une forme bilinéaire alternée non dégénérée 
  $e_l : E[l] \times E[l] \to \mathbb{U}_l$ telle que pour toute isogénie $\phi$, $\phi$ et $\h\phi$ soient adjoints pour $e_l$.
  Ici, $\mathbb{U}_l \subset \mathbb{C}$ 
  désigne l'ensemble des racines $l$-èmes de l'unité.
\end{prop}

\begin{proof}
  Admise.
\end{proof}

\begin{prop}
  \label{surj_el}
  Soit $S\in E[l]$ non nul. L'application $e_l(S,\cdot):E[l] \to \mathbb{U}_l$ est surjective.
\end{prop}

\begin{proof}
  Ici $l$ est un nombre premier différent de $p$. L'image de  $e_l(S,\cdot)$ est un sous groupe de $\mathbb{U}_l$ : cela ne peut être que \{1\} ou $\U_l$. Mais puisque $S$ est non nul, le caractère non dégénéré du pairing de Weil $e_l$ implique que l'image ne peut pas être réduite à \{1\}. L'application est donc surjective.
\end{proof}

\begin{prop}
  \label{pairing_base}
  Soient $v_1, v_2\in E[l]$ tels que $e(v_1, v_2)$ soit une racine $l$-ème primitive de l'unité. Alors $(v_1, v_2)$ est une base de $E[l]$. 
\end{prop}

\begin{proof}
  Puisque $E[l]$ est de dimension $2$ par le théorème \ref{structure_torsion}, il suffit de montrer que $(v_1, v_2)$ est libre. Par bilinéarité de $e_l$, $v_1$ et $v_2$ sont non nuls. Soient $a, b\in\Z$ tels que $av_1 + bv_2 = 0$. Alors $av_1 = -bv_2$, donc $1 = e_l(av_1, -bv_2) = e_l(v_1, v_2)^{-ab} = e_l(v_1, v_2)^{ab}$. Puisque par hypothèse $e_l(v_1, v_2)$ est une racine $l$-ème primitive de l'unité, cela implique que $l$ divise $ab$. Puisque $l$ est premier, on peut supposer sans perte de généralité que $l$ divise $a$. Ainsi $av_1 = 0$ (dans $E[l]$), et donc $bv_2=-av_1=0$. Puisque $E[l]$ est un $\Z/l\Z$ espace vectoriel et puisque $v_1$ et $v_2$ sont non nuls, cela signifie que $a=b=0$ dans $\Z/l\Z$.
\end{proof}

\begin{prop}
  \label{dettr}
  Soit $\phi$ un endomorphisme de $E$, $l$ un nombre premier différent de $p$, et $\phi_l$ l'endomorphisme induit par $\phi$ sur $E[l]$. Alors $\det(\phi_l) = [\deg(\phi)]_l$, et $\tr(\phi_l) = [1 + \deg(\phi) - \deg(1-\phi)]_l$, où pour tout $m\in\Z$, $[m]_l$ désigne la classe de $m$ modulo $l$. 
\end{prop}

La proposition précédente montre qu'il fait sens de définir la trace de $\phi$ par $\tr(\phi) = 1 + \deg(\phi) - \deg(1-\phi)$.

\begin{proof}
  Par la proposition \ref{surj_el}, il est possible de choisir $v_1$ et $v_2$ dans $E[l]$ tels que $e_l(v_1, v_2)$ soit une racine $l$-ème primitive de l'unité. Par la proposition \ref{pairing_base}, cela montre que $(v_2, v_2)$ est une $\Z/l\Z$-base de la $l$-torsion $E[l] \simeq \Z/l\Z\times\Z/l\Z$. 
  Soit $A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}$ la matrice de $\phi_l$ dans la base $(v_1, v_2)$.
  \begin{align*}
  e_l(v_1, v_2)^{\deg\phi} 
  &= e_l([\deg\phi]v_1, v_2) & \text{Linéarité à gauche} \\
  &= e_l(\h\phi_l(\phi_l(v_1)), v_2) & \text{Définition de $\h\phi$} \\
  &= e_l(\phi_l(v_1), \phi_l(v_2)) & \text{Caractère adjoint de $\h\phi$} \\
  &= e_l(av_1+cv_2, bv_1+dv_2) & \text{Écriture dans la base $(v_1, v_2)$} \\
  &= e_l(v_1, v_1)^{ab} e_l(v_1, v_2)^{ad} e_l(v_2, v_1)^{bc} e_l(v_2, v_2)^{cd} & \text{Bilinéarité} \\
  &= e_l(v_1, v_2)^{ad} e_l(v_2, v_1)^{bc} = e_l(v_1, v_2)^{ad-bc} & \text{Caractère alterné de $e_l$} \\
  &= e_l(v_1, v_2)^{\det\phi_l} & \text{Définition de $\det(\phi_l)$}
  \end{align*}
  Puisque $e_l(v_1, v_2)$ est une racine $l$-ème primitive de l'unité, on peut conclure que $\det\phi_l$ est égal à la classe de $\deg\phi$ modulo $l$.

   L'égalité suivante est vraie pour toute matrices $2\times 2$ : $\det(1-A) = (1-a)(1-d) - bc = 1 -a -d + ad -bc = 1 - \tr(A) + \det(A)$. Ainsi, en utilisant cette égalité et le lien entre le degré et le déterminant d'un endomorphisme on obtient bien $tr(\phi_l) = 1 + deg(\phi) - deg(1-\phi)$.   
\end{proof}

\begin{prop}
  Soit $\phi:E_1\to E_2$ une isogénie séparable. Alors $\# \Ker(\phi) = \deg(\phi)$.  
\end{prop}

\begin{proof}
  {\color{red} Ce serait bien de trouver une démonstration pour celle-là !}
\end{proof}

\begin{lem}
  \label{cardpi}
  Soit $E/\F_q$ une courbe elliptique. Le morphisme $1-\pi_q$ est séparable, et $\#E(\F_q) = deg(1 - \pi_q)$.
\end{lem}

\begin{proof}
  L'expression canonique du morphisme $1-\pi_q$ est $(1-\pi_q)(x, y) = (x-x^q, y-y^q)$. La dérivée par rapport à $x$ de la première composante est constante égale à $1$ et est donc non nulle. Par les propriétés \ref{caracsep} que $1-\pi_q$ est séparable.

  Puisque $1-\pi_q$ est séparable, par la proposition précédente $\deg(1-\pi_q) = \# \Ker(1-\pi_q)$. Or $\Ker(1-\pi_q) = \{(x, y) \in E(\overline{\F_p}) : (x, y) = (x^q, y^q) \} = E(\F_q)$. Ainsi $\# E(\F_q) = \deg(1-\pi_q)$.
\end{proof}

\begin{thm}
  \label{polcarac}
  Soit $E/\F_q$ une courbe elliptique et $\pi_q$ l'endomorphisme de Frobenius. Posons $t=q+1-\#E(\F_q)$. Alors $X^2 -tX + q = 0$ annule $\pi_q$.
\end{thm}

\begin{proof}
  En utilisant \ref{degpi} et \ref{cardpi}, $t$ se réécrit $t = 1 + \deg(\pi_q) - \deg(1-\pi_q)$. On reconnait l'expression de la trace de $\pi_q$ donnée en \ref{dettr}, et donc $t = \tr(\pi_q)$. Soit $\pi_{q, l}$ l'endomorphisme induit par $\pi_q$ sur $E[l]$. Le polynôme caractéristique de $\phi_l$ est $X^2 -\tr(\pi_{q,l}) X + \det(\pi_{q, l})$, donc $\pi_{q,l}^2 - t\pi_{q,l}+q = 0$. En appliquant une dernière fois \ref{dettr}, on obtient $\deg(\pi_{q}^2 - t\pi_{q}+q ) = \det (\pi_{q,l}^2 - t\pi_{q,l}+q ) = \det(0) = 0$, et donc par définition du degré on obtient l'égalité souhaitée.
\end{proof}

\begin{thm}
  \label{structure_torsion}
  Soit $E/\F_q$ une courbe elliptique. Soit $m\in \Z$ tel que $p$ ne divise pas $m$. Alors $E[m] \simeq {\Z}/{m\Z} \times  {\Z}/{m\Z}$
\end{thm}

\begin{proof}
Soit $d$ un diviseur de $m$. 
Par la proposition \ref{propriétés_duale}, $\deg([d]) = d^2$ . Puisque $p$ ne divise pas $d^2$ , et puisque le degré d'inséparabilité de $[d]$ doit être une puissance de $p$ divisant $d^2$ , le degré d'inséparabilité de $[d]$ vaut $1$. Ainsi $[d]$ est séparable. Donc $d^2 = \deg([d]) = \deg_s([d]) = \#\Ker([d]) = \#E[d]$. 
Avec cette condition sur les cardinaux des $E[d]$ et sachant $E[m]$ est abélien, on peut conclure que $E[m] \simeq {\Z}/{m\Z} \times  {\Z}/{m\Z}$.
\end{proof}



\begin{lem}
  Soit $A$ une matrice $2\times 2$ à coefficients dans un corps $K$. Pour tout $n\in\N$, $\tr(A^{n+2}) = \tr(A)\tr(A^{n+1}) - \det(A)\tr(A^n)$.
\end{lem}

\begin{proof}
  La trace et le déterminant restent inchangés si l'on considère la matrice $A$ comme étant à coefficients dans une extension de $K$. En prenant la clôture algébrique de $K$ on peut donc se ramener au cas où $K$ est algébriquement clos. De plus, la trace et le déterminant sont invariants par changement de base, donc on peut supposer la matrice $A$ triangulaire supérieure ($A$ est trigonalisable si et seulement si son polynôme caractéristique est scindé, ce qui est le cas en supposant $K$ algébriquement clos.) En posant $A = \begin{pmatrix} \alpha & * \\ 0 & \beta \end{pmatrix}$, on vérifie immédiatement que $\tr(A^{n+2}) = \alpha^{n+2} + \beta^{n+2} = (\alpha + \beta)(\alpha^{n+1} + \beta^{n+1}) - \alpha\beta(\alpha^n + \beta^n) = \tr(A)\tr(A^{n+1}) - \det(A)\tr(A^n)$.
\end{proof}

\begin{thm}
  \label{récurrence}
  Soit $\phi$ un endomorphisme de $E/\F_q$ une courbe elliptique et $\pi_q$ le morphisme de Frobenius. Pour $n\in\N$ notons $t_n = \tr(\pi_{q^n}) = \tr(\pi_q^n)$. Alors pour tout $n\in\N$, $t_{n+2} = t_1t_{n+1} - qt_n$.
\end{thm}

\begin{proof}
  Soit $n\in\N$. Soit $\phi$ un endomorphisme. Pour tout entier $l$ premier différent de $p$, 
  \begin{align*} 
    [\tr\phi^{n+2}]_l 
    &= \tr(\phi_l^{n+2}) 
    = \tr(\phi_l)\tr(\phi_l^{n+1})-\det(\phi_l)\tr(\phi_l^n) \\
    &= [\tr(\phi)]_l [\tr(\phi^{n+1})]_l-[\deg(\phi)]_l[\tr(\phi_l)]_l \\
    &= [\tr(\phi)\tr(\phi^{n+1})-\deg(\phi)\tr(\phi^n)]_l 
  \end{align*}
  Cette égalité étant vraie pour une infinité d'entiers $l$, on obtient $\tr\phi^{n+2} =  \tr(\phi)\tr(\phi^{n+1})-\deg(\phi)\tr(\phi^n)$. En appliquant cette égalité à $\phi = \pi_q$ et sachant que $\deg(\pi_q)=q$, on obtient bien $t_{n+2} = t_1t_{n+1}-qt_n$. 

\end{proof}

\begin{deff}
  $E$ est dite supersingulière si $E[p]$ est réduit à $O$. 
\end{deff}

\begin{prop}
  \label{pihatsep}
  Soit $E/\F_q$ une courbe elliptique. La courbe $E$ est supersingulière si et seulement si $\widehat{\pi_q}$ est (purement) inséparable.
\end{prop}

\begin{proof}
  Notons $q = p^r$. 

  Supposons que $E/\F_q$ soit supersingulière, c'est à dire que $E[p] = \{0\}$. Alors $1 = \#E[p] = \deg_s[p] = \deg_s(\h{\pi_{p}} \circ \pi_{p}) = \deg_s(\h{\pi_{p}})$. Ainsi $\deg_s(\h{\pi_{q}}) =  \deg_s(\h{\pi_{p}})^r= 1$, donc $\h{\pi_{p^r}}$ est purement inséparable.

  Supposons que $E$ ne soit pas supersingulière et montrons que $\h{\pi_{q}}$ est séparable. Puisque $E[p] \neq \{0\}$, $p$ divise $\#E[p] = \deg_s(\h{\pi_p})$. Or $\deg_s(\h{\pi_p})$ divise $\deg(\h{\pi_p}) = \deg({\pi_p}) = p$. Donc $\deg_s(\h{\pi_p}) = \deg(\h{\pi_p}) =p$, ce qui montre que $\h{\pi_p}$ est séparable, et donc que $\h{\pi_q}$ est séparable.
\end{proof}

\begin{prop}
  \label{pimodp}
  $E/\F_q$ est supersingulière si et seulement si $\tr(\pi_q) \equiv 0\ [p]$. 
\end{prop}

\begin{proof}
  Appliquons le théorème \ref{récurrence} : 
  notons $t_n = \tr(\pi_{q^n})$ 
  et alors pour tout $n\in\N$, 
  $t_{n+2} = t_1 t_{n+1} -qt_n$.
  En raisonnant modulo $p$, on obtient $t_{n+2} \equiv t_1 t_{n+1}\ [p]$, donc $t_n \equiv t_1^n\ [p]$. 
  De plus, $\#E(\F_{q^n}) = q^n + 1 - \tr(\pi_{q^n}) \equiv 1 - t_n\ [p]$.

Supposons $t_1 = \tr(\pi_q) \equiv 0\ [p]$. 
Alors $\#E(\F_{q^n}) = 1 - t_1^n \equiv 1\ [p]$ pour tout $n \ge 1$, donc par le théorème de Lagrange, $E(\F_{q^n})$ ne contient pas d’éléments d’ordre $p$, et donc $E[p] = \{0\}$.

Supposons $t_1 = \tr(\pi_q) \not\equiv 0\ [p]$. 
Alors $t_{p-1} = t_1^{p-1} \equiv 1\ [p]$, donc $\#E(\F_{q^{p-1}}) \equiv 0\ [p]$. Par le théorème de Cauchy, $E(\F_q^{p-1})$ contient un élément d’ordre $p$, et donc $E[p] \neq  \{0\}$.
\end{proof}


\begin{deff}[Forme quadratique]
  Soit $G$ un groupe abélien et $d:G\to \Z$. On dit que $d$ est une forme quadratique si pour tout $g \in G$, $d(g) = d(-g)$ et si l'application $G\times G \to \mathbb R$, définie par  $\langle g, h\rangle_d = \frac{1}{2}(d(g+h) - d(g) -d(h))$ est bilinéaire.

  Si de plus $d(g) = 0$ si et seulement si $g=0$, on dit que $d$ est définie. Si $d(g) \ge 0$ pour tout $g\in G$, on dit que $d$ est positive.
\end{deff}

\begin{rem}
  Soit $g, h\in G$ et $n\in \Z$. On remarque que $\langle g, -g\rangle_d = \frac{1}{2}(d(g + (-g)) - d(g) -d(-g)) =\frac{1}{2}( d(0) - d(g) -d(g)) = -d(g)$, donc $d(g) = -\langle g, -g\rangle_d = \langle g, g\rangle_d$. On remarque aussi que par définition $\langle\cdot,\cdot\rangle_d$ est symétrique. Ainsi on peut développer les formes quadratiques de façon usuelle : $d(g+h) =  d(g) + 2\langle g, h\rangle_d + d(h)$ et $d(ng) = n^2d(g)$.
\end{rem}

\begin{lem}[Inégalité de Cauchy-Schwarz]
  \label{Cauchy-Schwarz}
  Soit $G$ un groupe abélien. Et $d:G\to \mathbb Z$ une forme quadratique définie positive. Alors $|d(g+h) - d(g) -d(h)|\le 2\sqrt{d(g)d(h)}$ pour tout $g, h\in G$.  
\end{lem}

\begin{proof}
    Soit $g, h\in G$. On peut supposer $g\neq 0$, l'inégalité dans le cas $g=0$ étant triviale. Puisque $d$ est positive, pour tout $m, n\in \Z$ on a $0 \le d(mg + nh) = m^2d(g) + 2mn\langle g, h\rangle_d + n^2d(h)$. En particulier choisissons $m = -\langle g, h\rangle_d$ et $n=d(g)$. On obtient $0 \le  \langle g, h\rangle_d^2d(g) -2d(g)\langle g, h\rangle_d^2 + d(g)^2d(h) = d(g)(-\langle g, h\rangle_d^2 + d(g)d(h))$. Ainsi, puisque $g\neq 0$, $d(g)\neq 0$ et donc $\langle g, h\rangle_d^2 \le d(g)d(h)$. On en déduit directement le résultat énoncé.
  \end{proof}


\begin{prop}
  \label{degré_quadratique}
  Soit $E$ une courbe elliptique. L'application $\deg : \End(E) \to \mathbb N$ est une forme quadratique.
\end{prop}

\begin{proof}
  On remarque premièrement que par définition, le degré est défini positif. Soit $\phi$ un endomorphisme de $E$ non constant. On remarque que $(-\phi)^*K(E) = \phi^*K(E)$, (on utilise le fait que $K(E)$ est un corps, et que $[-1]$ est un endomorphisme) donc $\deg(-\phi) = \deg(\phi)$. Il ne reste plus qu'à montrer la bilinéarité de $\langle \phi, \psi\rangle = \frac{1}{2}(\deg(\phi+\psi) - \deg(\phi) -\deg(\psi))$. On utilise pour cela le morphisme d'anneaux injectif $[\cdot] :\Z\to \End E$. En remarquant que $[\langle \phi, \psi\rangle] = \h{(\phi + \psi)}(\phi + \psi) - \h\phi\phi -\h\psi\psi =  (\h\phi + \h\psi)(\phi + \psi) - \h\phi\phi -\h\psi\psi = \h\phi\psi + \h\psi\phi$, on voit clairement que $\langle\cdot,\cdot\rangle$ est bilinéaire.
\end{proof}

\begin{thm}[Borne de Hasse]
  \label{hasse}
  Soit $E$ une courbe elliptique définie sur $\F_q$. Alors $|\#E(\F_q) - q -1|\le 2\sqrt{q}$.
\end{thm}

\begin{proof}
  Appliquons l'inégalité de Cauchy-Schwarz (lemme \ref{Cauchy-Schwarz})  la forme quadratique définie positive $\deg : \End E \to \Z$ (proposition \ref{degré_quadratique}). Pour $\phi, \psi\in \End E$, $|\deg(\phi+\psi) - \deg\phi -\deg\psi| \le 2\sqrt{(\deg\phi)(\deg\psi)}$. Utilisons cette inégalité avec $\phi = [1]$ et $\psi = -\pi_q$. On sait déjà que $\deg[1] = 1$ (remarque \ref{degpi}) et $\deg(-\pi_q) = q$ (propriété \ref{propriétés_duale}). 
  Par le lemme \ref{cardpi}, on sait que $\#E(\F_q) = \deg([1] - \pi_q)$, donc finalement $|\#E(\F_q)-q-1| \le 2\sqrt{q}$.
\end{proof}

\begin{prop}
  Toute courbe elliptique $E/\overline{\F_p}$ a son $j$-invariant dans $\F_{p^2}$, donc une telle courbe est $\overline{\F_p}$-isomorphe à une courbe définie sur $\F_{p^2}$. 
\end{prop}

\begin{proof}
  Puisque $E$ est supersingulière, $\h{\pi_p} : E^{(p)} \to  E$ est purement inséparable, donc $\h{\pi_p} = \psi \circ \pi_p$ avec $\psi : E^{(p^2}) \to E$ une isogénie de degré $1$. Une telle isogénie est un isomorphisme, donc $ E^{(p^2}) $ est $\ol{\F_p}$-isomorphe à $E$. Ainsi $j(E) = j( E^{(p^2}) ) = j(E)^{p^2}$ donc $X^{p^2} - X$ annule $j(E)$, ce qui revient à dire que $j(E)$ appartient à $\F_{p^2}$.
\end{proof}

\begin{prop}
\label{cardsuper} 
  Soit $E/\F_{p^2}$ une courbe supersingulière définie sur $\F_{p^2}$. $E$ est isomorphe à une courbe définie sur $\F_{p^2}$ de cardinal $E(\F_{p^2}) = p^2 + 1 + 2p = (p+1)^2$.
\end{prop}

\begin{proof}
  Soit $\pi_{p^2}$ le Frobenius de la courbe $E$. En combinant la borne de Hasse $-2p \le \tr(\pi_{p^2}) \le 2p$ (théorème \ref{hasse}) et la proposition \ref{pimodp} $\tr(\pi_{p^2}) \equiv 0\ [p]$, on obtient $\tr(\pi_{p^2}) \in \{-2p, -p, 0, p, 2p\}$.  Nous allons distinguer les cas selon la valeur de $\tr(\pi_{p^2})$.
   
  \vspace{1em}
  Si $\tr(\pi_{p^2}) = -2p$, il n'y a rien à faire. On rappelle juste que $E(\F_{p^2}) = p^2 + 1 - \tr(\pi_{p^2})$ 
    
  \vspace{1em}
  Supposons que $\tr(\pi_{p^2}) = 2p$. Tous les $\overline{\F_p}$-isomorphismes entre courbes elliptiques préservant la forme de Weierstrass réduite sont de la forme 
      $\varphi : E \to E', (x, y) \mapsto (u^2 x, u^3 y)$ avec $u\in\overline{\F_p}$. Notons $E : y^2 = x^3 + ax +b$. L'équation $E'$ s'écrit donc $E' : u^6 y^2 = u^6 x^3 + u^2 a x + b$, (soit $E' : y^2 = x^3 + u^{-4} a x + u^{-6}b$ si l'on souhaite une forme réduite). On peut choisir $u^2\in\F_{p^2}$ avec $u\notin \F_{p^2}$, et alors $E'$ est définie sur $\F_{p^2}$, mais ne possède pas le même nombre de points dans $\F_{p^2}$ que $E$.

Comptons le nombre de points de $\#E(\F_{p^2}) + \#E'(\F_{p^2})$. $E'$ se réécrit encore $E' : u^2 (u^2 y)^2 = (u^2 x)^3 + a (u^2 x) + b$. Puisque $u^2\in \F_{p^2}^\times$, $\#E'(\F_{p^2}) = \#E''(\F_{p^2})$ avec $E'' : u^2 y^2 = x^3 + a x + b$, soit encore $E'' : y^2 = u^{-2} (x^3 + ax + b)$.
      La multiplication par $u^2$ est une bijection entre les carrés de $\F_{p^2}^\times$ et les éléments qui ne sont pas des carrés de $\F_{p^2}^\times$. 
      Ainsi, si $x^3 + ax + b$ est un carré non nul de $\F_{p^2}$, $E$ possède deux solutions pour un tel $x$ et $E''$ aucune. Si ce n'est pas un carré, $E$ ne possède pas de solutions et $E''$ en possède deux. Enfin si cette quantité est nulle, $E$ et $E''$ possèdent chacune une solution. 
Dans tous les cas, pour une abscisse $x$ fixée, $E$ et $E''$ possèdent au total $2$ points possédant une telle abscisse.
En n'oubliant que le point à l'infini appartient aussi aux deux courbes, on obtient :
      $ \#E(\F_{p^2}) + \#E'(\F_{p^2}) = 2p^2  + 2 = 2(p^2 + 1)$. Ainsi $\#E'(\F_{p^2}) = p^2 + 1 + \tr(\pi_{p^2}) = p^2 + 1 + 2p$. 
     
\vspace{1em}
Pour traiter les derniers cas nous serons amenés à étudier les automorphismes de $E$ (voir le théorème III.10.1 dans Silverman). Puisque $E$ est supersingulière, $\widehat{\pi_p} : E^{(p)} \to E$ est purement inséparable donc se factorise en  $\widehat{\pi_p} = \psi \circ \pi_p$. Sachant que $\deg(\widehat{\pi_p}) = \deg(\pi_p) = p^2$, $\psi$ est de degré $1$ et donc est un isomorphisme. De plus $\widehat{\pi_p}\pi_p = [p]$, et $E^{(p^2)} = E$, le diagramme suivant est commutatif: 

\begin{center}
  \begin{tikzcd}
          E \arrow[rrd, "p"] \arrow[r, "\pi_p"] & E^{(p)} \arrow[rd, "\widehat{\pi_p}"] \arrow[r, "\pi_p"] &E \arrow[d, "\psi"]\\
                                 &  & E
  \end{tikzcd}
\end{center}
Ainsi $\pi_{p^2} = \psi^{-1} \circ [p]$.

\vspace{1em}
Dans le cas où $\tr(\pi_{p^2}) = 0$, $\pi_{p^2}^2 + [p^2] = 0$ donc $-[p^2] = \pi_{p^2}^2 = (\psi^{-1} \circ [p])^2 = \psi^{-2} \circ [p^2]$ puisque tout morphisme commute avec $[m]$. Alors $(\psi^{-2} +1)\circ [p^2] = 0\in \End(E)$ donc $[p^2]$ étant surjective, $\psi^2 = -\text{Id}$.
Ainsi $\psi$ est d'ordre $4$, donc par le théorème III.10.1 (Silverman) (caractéristique $\neq 2, 3$) $j(E) = 1728$.
Ainsi $E$ est $\overline{\F_p}$-isomorphe à une courbe $y^2=x^3 + ax$ qui est de cardinal $(q+1)^2$.

\vspace{1em}
Dans les dernier cas, où $\tr(\pi_{p^2}) = \pm p$, $X^2 \pm p X +p^2$ annule $\pi_{p^2}^2$ et puisque $X^6 - p^6 = p^6 ((\frac{X}{p})^6 - 1) = (X-1)(X+1)(X^2 -pX + p^2)(X^2 + pX + p^2)$, $\pi_{p^2}^6 = [p^6]$. Ainsi $[p^6] = \pi_{p^2}^6  = (\psi^{-1} \circ [p])^6 = \psi^{-6} \circ [p^6]$, donc $\psi^6 = \text{Id}$. Le théorème III.10.1 permet de conclure si l'ordre de $\psi$ est $3$ ou $6$, il suffit donc de montrer que l'ordre de $\psi$ ne peut être ni $1$, ni $2$.
Si $\psi$ est d'ordre $1$, $\pi_{p^2} = [p]$, donc $\tr(\pi_{p^2}) = \tr([p]) = 1 + \deg([p]) - \deg([1-p]) = 1 + p^2 -(p-1)^2 = 2p$, ce qui contredit l'hypothèse $\tr(\pi_{p^2}) = \pm p$. 
Si $\psi$ est d'ordre $2$, $\pi_{p^2}^2 = (\psi^{-1} \circ [p])^2 = \psi^{-2} \circ [p^2] = - [p^2]$, donc $\pi_{p^2}^6 = -[p^6]$ ce qui contredit $[p^6] = \pi_{p^2}^6$. 
\end{proof}

\begin{thm}[Tate]
  \label{tate}
Étant donné deux courbes elliptiques $E_1$ et $E_2$ définies sur $\F_{q}$, et soit $n\in\N^*$. Il existe une isogénie (non constante par définition) $\varphi : E_1 \to E_2$ définie sur $\F_{q^n}$ si et seulement si $\# E_1(\F_{q^n}) = \# E_2(\F_{q^n})$. 
\end{thm}

\begin{proof}
  Admise.
\end{proof}

\begin{cor}
  Le graphe des isogénies (que l'on a pas encore construit) entre courbes supersingulières définies sur $\F_{p^2}$ est connexe.
\end{cor}

\begin{proof}
  En combinant du théorème de Tate (\ref{tate}) et de la proposition \ref{cardsuper}, on obtient qu'entre deux classe de $\overline{\F_p}$-isomorphisme entre courbes elliptiques supersingulières définies sur $\F_{p^2}$ il existe toujours une isogénie.
\end{proof}

\section{Construction d'une courbe initiale}

L'objectif de cette partie est de construire une courbe elliptique supersingulière adaptée. 
On souhaite que cette courbe ait pour cardinalité un entier possédant de petit facteurs premiers pour pouvoir calculer efficacement des isogénies. 
On souhaite aussi pouvoir trouver des courbes de cardinalité arbitrairement grande pour pouvoir adapter la longueur des clefs, et donc la sécurité, du protocole cryptographique.
Puisque chaque courbe supersingulière est $\overline{\F_p}$-isomorphe à une courbe définie sur $\F_{p}$ ou $\F_{p^2}$, on ne considérera que des courbes à coefficients dans $\F_{p^2}$ par la suite.
Plus précisément, nous allons étudier la courbe $E_0 : y^2 = x^3 + b$ sur $\F_{p^2}$ avec $b\in\F_{p}^\times$ et montrer que sous certaines conditions sur $p$, cette courbe est supersingulière et de bonne cardinalité.


Commençons par compter le nombre de points de $E_0$ sur $\F_{p}$. Pour cela nous montrons d'abord un résultat sur le nombre de carrés dans $\F_{p}$.

\begin{prop}
  Soit $p$ un nombre premier impair. $\F_{p}$ contient $\frac{p+1}{2}$ carrés.
\end{prop}

\begin{proof}
  $\F_{p}^\times$ est un groupe cyclique d'ordre $p-1$. 
  Notons $g$ un générateur de $\F_{p}^\times$. 
  
  L'application $ \varphi \colon \frac{\Z}{(p-1)\Z} \to \F_{p}^\times$,
  $[k] \mapsto g^k$
  est bien définie et est un isomorphisme de groupes.
  Soit $a\in \F_{p}^\times$, et soit $[k] = \psi^{-1}(a)$.
  Si $k$ est pair, ce qui a un sens puisque $p-1$ est pair, $a = g^k = (g^\frac{k}{2})^2$, donc $a$ est un carré.
  Réciproquement, si $a$ est un carré, il existe $[l]\in \Z/(p-1)\Z$ tel que $a = (g^l)^2 = g^{2l}$.
  Alors $[k] = [2l]$ donc $k$ est pair.
  Il y a donc autant de carrés dans $\F_{p}^\times$ que de nombres pairs dans $\Z/{(p-1)\Z}$, soit $\frac{p-1}{2}$. 
  En comptant $0$, il y a $\frac{p+1}{2}$ carrés dans $\F_{p}$. 
\end{proof}

\begin{prop}
  Si $p$ est impair et si $p \equiv 2 [3]$, alors $\#E_0(\F_{p}) = p+1$.
\end{prop}

\begin{proof}
  Considérons le morphisme de groupes $\varphi \colon \F_{p}^\times \to \F_{p}^\times$, $x \mapsto x^3$. 
  Soit $x\in \ker \varphi$, $x^3 = 1$, donc l'ordre de $x$ noté $o(x)$ divise $3$. 
  Par le théorème de Lagrange, $o(x)\ |\ \#\F_{p}^\times$, donc $o(x)\ |\ p-1$. 
  Or par hypothèse $p-1\equiv 1[3]$, donc $o(x) = 1$, donc $x = 1$.
  Ainsi $\ker \varphi = {1}$, donc $\varphi$ est injective, et donc bijective par égalité des cardinaux.

  On en déduit immédiatement que l'application $x \mapsto x^3 + b$ de $\F_{p}$ dans $\F_{p}$ est bijective.
  Nous pouvons maintenant compter le nombre de points de $E$ dans $\F_{p}$. 
  Si $x^3 + b$ est un carré non nul de $\F_{p}$, deux valeurs différentes de $y$ sont solutions de l'équation $E$. 
  Si $x^3 + b = 0$, $y = 0$ est la seule valeur qui convient.
  Enfin si $x^3 + b$ n'est pas un carré de $\F_{p}$, $E$ ne possède pas de solution.
  En n'oubliant pas que le point à l'infini $O$ est aussi solution de $E$, et en utilisant le lemme, on obtient : $\#E(\F_{p}) = 2\frac{p-1}{2} + 1 + 1 = p+1$.
\end{proof}

À partir de maintenant on suppose que $p$ est un nombre premier impair congru à $2$ modulo $3$. 
Ainsi $\#E_0(\F_{p}) = p+1$. 


On cherche maintenant à calculer le nombre de points de la courbe $E_0$ sur $\F_{p^2}$ en connaissant le nombre de points de la courbe sur $\F_{p}$.

\begin{cor}
$\#E_0(\F_{p^2}) = (p+1)^2$.
\end{cor}

\begin{proof}
  En utilisant le théorème \ref{récurrence}, avec $q = p$, on obtient $t_2 = t_1^2 - pt_0 = -2p$. Donc $\#E(\F_{p^2}) = p^2 + 1 - t_2 = p^2 + 1 + 2p = (p+1)^2$.
\end{proof}


Montrons maintenant que la courbe $E_0$ est supersingulière.

\begin{thm}
  Soit $K$ un corps de caractéristique $p\ge 2$, et soit $E/K$ une courbe elliptique. $\mathrm{End}(E)$ est isomorphe soit à un ordre d'un corps quadratique, soit à un ordre dans une algèbre de quaternions. 
\end{thm}

\begin{proof}
  Voir le théorème V.3.1 dans le Silverman.
\end{proof}

\begin{thm}
  Soit $E/\F_q$ une courbe elliptique, $E$ est supersingulière si et seulement si $\End(E)$ est un ordre dans une algèbre de quaternions.
\end{thm}

\begin{cor}
  $E_0$ est supersingulière.
\end{cor}

\begin{proof}
Ainsi, pour prouver qu'une courbe elliptique est supersingulière, il suffit de trouver deux endomorphismes qui ne commutent pas.
Considérons le morphisme de Frobenius $\pi_p : E_0/\F_{p^2} \to E_0^{(p)}/\F_{p^2}$, $(x, y) \mapsto (x^p, y^p)$. 
Puisque $E_0$ est définie sur $\F_{p}$, $\pi_p$ est un endomorphisme de $E/\F_{p^2}$.

Soit $j$ une racine de $X^2 + X + 1$. 
Par définition, $j$ appartient à $\F_{p^2}$. 
Dans quelles conditions est-ce que $j$ appartient à $\F_{p}$ ? 
$j^3 = -j^2 -j = 1$, donc $j$ est d'ordre $3$. 
Si $j\in \F_{p}$ alors $3\ |\ p-1$ par le théorème de Lagrange, soit $p\equiv 1[3]$. 
Par contraposition, si $p \equiv 2 [3]$ alors $j\in\F_{p^2}\setminus\F_{p}$.

Considérons l'endomorphisme $\psi : E_0 \to E_0$, $(x, y) \mapsto (jx, y)$. 
Remarquons que puisque $j^3 = 1$, $\psi$ est bien défini.
De plus $\pi_p(\psi(x, y)) = \pi_p(jx, y) = (j^px^p, y^p)$, mais $\psi(\pi_p(x, y)) = \psi(x^p, y^p) = (jx^p, y^p)$. 
Puisque $j^p\neq j$, $\pi_p \circ \psi \neq \psi \circ \pi_p$, donc End($E$) n'est pas commutatif.
Ainsi $E$ est supersingulière.
\end{proof}

On s'intéresse maintenant à la structure des groupes de torsion de $E_0$ sur $\F_{p^2}$. Pour cela nous avons d'abord besoin d'informations sur la structure des groupes de torsion dans la clôture algébrique de $\F_{p}$.

\begin{prop}
  $$E_0(\F_{p^2}) \simeq \Z/(p+1)\Z \times \Z/(p+1)\Z$$
\end{prop}

\begin{proof}
  Utilisons à nouveau le théorème \ref{polcarac} en posant $q = p^2$. 
  Posons $\pi_{p^2}$ le morphisme de Frobenius.
  En constatant que $\tr(\pi_{p^2}) = -2p$, on obtient que $\pi_{p^2}^2 + 2p\pi_{p^2} + [p^2] = 0$, donc que $\left( \pi_{p^2} + [p] \right) ^2 = 0$ dans End($E_0(\overline{\F_p})$). 
  Ainsi $\deg(\pi_{p^2} + [p])^2 = 0$, donc $\deg(\pi{p^2} + [p]) = 0$, donc $\pi_{p^2} + [p] = 0$.

  Soit $P\in E_0(\overline{\F_{p}})$. $P \in E_0(\F_{p^2})$ ssi $\pi_{p^2}(P) = P$, donc $E(\F_{p^2}) = \ker(\text{Id} - \pi_{p^2}) = \ker([1] + [p]) = \ker([p+1])$.
  En utilisant la proposition précédente, puisque $p$ ne divise pas $p+1$, on obtient le résultat souhaité.
\end{proof}

On considère maintenant la décomposition de $p + 1$ suivante : $p + 1 = 2^a 3^b f$, avec $2 \nmid f$ et $3 \nmid f$. Puisque l'on a déjà supposé $p\ge 3$ et $p \equiv 2\ [3]$, on a $a, b\ge 1$. Avec ces notations, on s'intéresse à la $2^a$ et à la $3^b$-torsion de $E_0$. Pour éviter d'écrire deux fois la même chose, le couple $\left( l, e \right)$ désigne soit le couple $(2, a)$ soit le couple $(3, b)$ dans les preuves suivantes. 

\begin{prop}
  $$E_0(\F_{p^2})[l^e] \simeq \Z/l^e\Z \times \Z/l^e\Z$$
\end{prop}

\begin{proof}
  D'abord, par la proposition précédente, $\Z/l^e\Z \times \Z/l^e\Z$ est isomorphe à un unique sous-groupe de $E_0(\F_{p^2})$.
  Il suffit donc de montrer une double inclusion entre deux sous-groupes de $E_0(\F_{p^2})$.
  L'inclusion \allowbreak$E_0(\F_{p^2})[l^e] \supseteq \Z/l^e\Z \times \Z/l^e\Z$ est évidente en remarquant que tout élément de $\Z/l^e\Z \times \Z/l^e\Z$ a un ordre qui divise $l^e$.
  
  Pour l'inclusion réciproque on peut par exemple utiliser les théorèmes de Sylow. 
  Par définition, $E_0(\F_{p^2})[l^e]$ est un $l$-sous-groupe de $E_0(\F_{p^2})$, il est donc contenu dans un $l$-Sylow. 
  Puisque $E_0(\F_{p^2})$ est abélien, et puisque les $l$-Sylow sont conjugués, il existe un unique $l$-Sylow. 
  En remarquant que $\Z/l^e\Z \times \Z/l^e\Z$ est un $l$-Sylow par la proposition précédente, on démontre l'inclusion manquante et donc l'isomorphisme annoncé. 
\end{proof}

On s'intéresse maintenant au nombre de sous-groupes cycliques de la $2^a$ ou $3^b$-torsion.

\begin{prop}
  $E_0(\F_{p^2})[l^e]$ contient $l^{e-1}(l+1)$ sous-groupes cycliques d'ordre $l^e$.
\end{prop}
\begin{proof}
  Comptons le nombre d'éléments d'ordre $l^e$ dans $\Z/l^e\Z \times \Z/l^e\Z$.
  Soit $\left( x, y \right) \in \Z/l^e\Z \times \Z/l^e\Z$, $o((x, y)) =\textrm{ppcm}(o(x), o(y)) = \max(o(x),o(y))$, donc un couple d'éléments de $\Z/l^e\Z$ est d'ordre $l^e$ si et seulement si un des éléments est d'ordre $l^e$. Alors, 
  $$\#\{(x, y)\ |\  o((x, y)) = l^e\} = \#\{(x, y)\ |\ o(x) = l^e\} +  \#\{(x, y)\ |\ o(y) = l^e\} - \#\{(x, y)\ |\ o(x) = o(y) = l^e\}$$
  Notons $\alpha = l^{e} - l^{e-1}$ le nombre de générateurs de $\Z/l^e\Z$.  
  Ainsi le nombre de sous sous-groupes cycliques d'ordre $l^e$ de la $l^e$-torsion est $({2l^e\alpha -\alpha^2})/{\alpha} = 2l^e-\alpha = l^e + l^{e-1} = l^{e-1}(l + 1)$.
\end{proof}

\begin{prop}
  Soient $P$ et $Q$ deux éléments de $\Z/l^e\Z \times \Z/l^e\Z$. 
  $(P, Q)$ est $\Z/l^e\Z $-libre ssi $(l^{e-1}P, l^{e-1}Q)$ est $\Z/l\Z $-libre. 
\end{prop}

\begin{proof}
  L'équivalence précédente se réécrit :
  $$\left( \forall a, b \in \Z,\ aP + bQ = 0 \Rightarrow a \equiv b \equiv 0\ [l^e] \right) \iff \left( \forall a, b \in \Z,\ a l^{e-1}P + b l^{e-1}Q = 0 \Rightarrow a \equiv b \equiv 0\ [l] \right) $$
  Montrons l'implication directe. Soient $a, b\in \Z$ tels que $a l^{e-1}P + b l^{e-1}Q = 0$. 
  Par hypothèse, $l^{e-1}a \equiv l^{e-1}b \equiv 0\ [l^e]$, ce qui montre directement que $a \equiv b \equiv 0\ [l]$. 

  Montrons maintenant l'implication réciproque. Soient $a, b \in \Z$ tels que $aP + bQ = 0$. 
  Dans le cas où $a$ et $b$ sont non nuls, on réécrit $a = a' l^{v_l(a)}$ et $b = b' l^{v_l(b)}$ avec $v_l(a)$ et $v_l(b)$ les valuations $l$-adiques de $a$ et de $b$. 
  Ainsi, $a' l^{v_l(a)}P + b' l^{v_l(b)}Q = 0$. 
  Sans perte de généralité, on peut supposer que $v_l(a) \le v_l(b)$. 
  Si $v_l(a) \le e-1$, en multipliant l'équation précédente par $l^{e-1-v_l(a)}$ on obtient $a' l^{e-1}P + b' l^{e-1 + v_l(b) - v_l(a)}Q = 0$, et ainsi $a' \equiv 0\ [l]$, ce qui contredit la définition de $v_l(a)$. 
  Ainsi $v_l(b) \ge v_l(a) \ge e$, donc $a \equiv b \equiv 0\ [l^e]$. Le cas $a=b=0$ est trivial. Dans le cas où $a\neq0$ et $b=0$ par exemple, la preuve précédente reste correcte en écrivant $b = 0\cdot l^{v_l(a)}$.
\end{proof}


\section{Cryptographie}



\end{document}

